cve: 2017-12629
title: "Apache Solr config API add-listener command is vulnerable to Remote Code Execution attacks"
description: >
    Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class.
cvss_v2: 7.5
references:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-12629
    - http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12629
    - http://www.cvedetails.com/cve/CVE-2017-12629/
    - http://lucene.472066.n3.nabble.com/Re-Several-critical-vulnerabilities-discovered-in-Apache-Solr-XXE-amp-RCE-tt4358355.html
affected:
    - groupId: "org.apache.solr"
      artifactId: "solr-core"
      version:
        - "<=7.0.1"
        - ">=5.5.0"
      fixedin:
        - "==5.5.5"
        - "==6.6.2"
        - ">=7.0.2"
package_urls:
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.0/solr-core-6.6.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/1.4.1/solr-core-1.4.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.10.4/solr-core-4.10.4.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.2.1/solr-core-4.2.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.3.0/solr-core-5.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.3.2/solr-core-5.3.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/1.4.0/solr-core-1.4.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.2.0/solr-core-3.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.10.0/solr-core-4.10.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.7.2/solr-core-4.7.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.2/solr-core-6.6.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.10.2/solr-core-4.10.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.5.0/solr-core-3.5.0.jar
    - https://maven.repository.redhat.com/ga/org/apache/solr/solr-core/3.6.2-redhat-4/solr-core-3.6.2-redhat-4.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.3/solr-core-5.5.3.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.1.0/solr-core-6.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.4.0/solr-core-3.4.0.jar
    - https://maven.repository.redhat.com/ga/org/apache/solr/solr-core/3.6.2-redhat-2/solr-core-3.6.2-redhat-2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.1.0/solr-core-4.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.2.1/solr-core-6.2.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.9.0/solr-core-4.9.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.10.3/solr-core-4.10.3.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.0.0/solr-core-4.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.8.1/solr-core-4.8.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.1.0/solr-core-6.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.2/solr-core-6.4.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.7.0/solr-core-4.7.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.2.1/solr-core-6.2.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.6.2/solr-core-3.6.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.2.0/solr-core-5.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.3/solr-core-5.5.3.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.2/solr-core-6.6.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.5.1/solr-core-6.5.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.0.0/solr-core-7.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.0/solr-core-6.6.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.3.0/solr-core-6.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.6.1/solr-core-4.6.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.4/solr-core-5.5.4.jar
    - https://maven.repository.redhat.com/ga/org/apache/solr/solr-core/3.6.2-redhat-3/solr-core-3.6.2-redhat-3.jar
    - https://maven.repository.redhat.com/ga/org/apache/solr/solr-core/3.6.2.redhat-8/solr-core-3.6.2.redhat-8.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.1/solr-core-6.4.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.2.1/solr-core-7.2.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.0.0/solr-core-6.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.5.0/solr-core-6.5.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.0.0-BETA/solr-core-4.0.0-BETA.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.0.0/solr-core-5.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.0.1/solr-core-7.0.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.8.0/solr-core-4.8.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.0/solr-core-6.4.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.5/solr-core-5.5.5.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.2/solr-core-5.5.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.1.0/solr-core-7.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.1/solr-core-6.4.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.3.1/solr-core-5.3.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.1/solr-core-5.5.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.1.0/solr-core-5.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.2.0/solr-core-7.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.0.1/solr-core-6.0.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.1/solr-core-6.6.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.0.0/solr-core-6.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.0/solr-core-5.5.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.3.0/solr-core-4.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.6.1/solr-core-6.6.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.2/solr-core-5.5.2.jar
    - https://maven.repository.redhat.com/ga/org/apache/solr/solr-core/3.6.2-redhat-5/solr-core-3.6.2-redhat-5.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.0.1/solr-core-6.0.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.5/solr-core-5.5.5.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.5.1/solr-core-4.5.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.1/solr-core-5.5.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.3.0/solr-core-6.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.5.1/solr-core-6.5.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.0.0/solr-core-7.0.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.2.0/solr-core-6.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.6.0/solr-core-3.6.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.7.1/solr-core-4.7.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.5.0/solr-core-4.5.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.2/solr-core-6.4.2.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.0/solr-core-5.5.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.4.0/solr-core-6.4.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.6.1/solr-core-3.6.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.5.0/solr-core-6.5.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/7.0.1/solr-core-7.0.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.2.0/solr-core-4.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.4.0/solr-core-4.4.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.2.1/solr-core-5.2.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.9.1/solr-core-4.9.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.10.1/solr-core-4.10.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.3.1/solr-core-4.3.1.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.6.0/solr-core-4.6.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.1.0/solr-core-3.1.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/3.3.0/solr-core-3.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.4.0/solr-core-5.4.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/1.3.0/solr-core-1.3.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/6.2.0/solr-core-6.2.0.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.5.4/solr-core-5.5.4.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/4.0.0-ALPHA/solr-core-4.0.0-ALPHA.jar
    - http://central.maven.org/maven2/org/apache/solr/solr-core/5.4.1/solr-core-5.4.1.jar
