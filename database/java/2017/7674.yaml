cve: 2017-7674
title: "Tomcat: Vary header added by CORS filter leading to cache poisoning"
description: >
    The CORS Filter did not add an HTTP Vary header indicating that the response varies depending on Origin. This permitted client and server side cache poisoning in some circumstances.
references:
    - https://bugzilla.redhat.com/show_bug.cgi?id=1480618
    - https://tomcat.apache.org/security-7.html
    - https://tomcat.apache.org/security-8.html
affected:
    - groupId: "org.apache.tomcat"
      artifactId: "tomcat-catalina"
      version:
        - "<=8.5.15,8.5"
        - "<=8.0.44,8.0"
        - "<=7.0.78,7"
      fixedin:
        - ">=8.5.16,8.5"
        - ">=8.0.45,8.0"
        - ">=7.0.79,7"
package_urls:
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.0-RC1/tomcat-catalina-8.0.0-RC1.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.63/tomcat-catalina-7.0.63.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.3/tomcat-catalina-8.0.3.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.37/tomcat-catalina-8.0.37.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.5/tomcat-catalina-7.0.5.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.22/tomcat-catalina-8.0.22.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.6/tomcat-catalina-7.0.6.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.2/tomcat-catalina-7.0.2.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.9/tomcat-catalina-8.0.9.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.53/tomcat-catalina-7.0.53.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.14/tomcat-catalina-8.0.14.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.23/tomcat-catalina-7.0.23.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.0-RC3/tomcat-catalina-8.0.0-RC3.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.26/tomcat-catalina-8.0.26.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.73/tomcat-catalina-7.0.73.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.9/tomcat-catalina-8.5.9.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.17/tomcat-catalina-8.0.17.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.12/tomcat-catalina-8.0.12.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.39/tomcat-catalina-7.0.39.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.12/tomcat-catalina-8.5.12.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.21/tomcat-catalina-7.0.21.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.30/tomcat-catalina-8.0.30.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.2/tomcat-catalina-8.5.2.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.25/tomcat-catalina-7.0.25.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.36/tomcat-catalina-8.0.36.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.78/tomcat-catalina-7.0.78.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.29/tomcat-catalina-8.0.29.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.8/tomcat-catalina-7.0.8.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.15/tomcat-catalina-8.5.15.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.27/tomcat-catalina-8.0.27.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.65/tomcat-catalina-7.0.65.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.0-RC10/tomcat-catalina-8.0.0-RC10.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.56/tomcat-catalina-7.0.56.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.43/tomcat-catalina-8.0.43.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.29/tomcat-catalina-7.0.29.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.28/tomcat-catalina-8.0.28.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.8/tomcat-catalina-8.0.8.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.68/tomcat-catalina-7.0.68.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.11/tomcat-catalina-7.0.11.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.64/tomcat-catalina-7.0.64.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.35/tomcat-catalina-8.0.35.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.8/tomcat-catalina-8.5.8.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.5/tomcat-catalina-8.5.5.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.35/tomcat-catalina-7.0.35.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.42/tomcat-catalina-8.0.42.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.6/tomcat-catalina-8.5.6.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.11/tomcat-catalina-8.0.11.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.18/tomcat-catalina-8.0.18.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.55/tomcat-catalina-7.0.55.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.72/tomcat-catalina-7.0.72.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.11/tomcat-catalina-8.5.11.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.13/tomcat-catalina-8.5.13.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.0-RC5/tomcat-catalina-8.0.0-RC5.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.26/tomcat-catalina-7.0.26.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.62/tomcat-catalina-7.0.62.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.50/tomcat-catalina-7.0.50.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.4/tomcat-catalina-8.5.4.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.16/tomcat-catalina-7.0.16.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.0/tomcat-catalina-8.5.0.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.42/tomcat-catalina-7.0.42.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.32/tomcat-catalina-7.0.32.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.38/tomcat-catalina-8.0.38.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.14/tomcat-catalina-8.5.14.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.5.3/tomcat-catalina-8.5.3.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.39/tomcat-catalina-8.0.39.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.57/tomcat-catalina-7.0.57.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.20/tomcat-catalina-8.0.20.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.59/tomcat-catalina-7.0.59.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.5/tomcat-catalina-8.0.5.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.20/tomcat-catalina-7.0.20.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.41/tomcat-catalina-7.0.41.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.69/tomcat-catalina-7.0.69.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.52/tomcat-catalina-7.0.52.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.40/tomcat-catalina-7.0.40.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.67/tomcat-catalina-7.0.67.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.32/tomcat-catalina-8.0.32.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.54/tomcat-catalina-7.0.54.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.28/tomcat-catalina-7.0.28.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.1/tomcat-catalina-8.0.1.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.15/tomcat-catalina-8.0.15.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.70/tomcat-catalina-7.0.70.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.33/tomcat-catalina-7.0.33.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.0/tomcat-catalina-7.0.0.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.12/tomcat-catalina-7.0.12.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.47/tomcat-catalina-7.0.47.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.23/tomcat-catalina-8.0.23.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.61/tomcat-catalina-7.0.61.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.21/tomcat-catalina-8.0.21.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.24/tomcat-catalina-8.0.24.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.4/tomcat-catalina-7.0.4.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.34/tomcat-catalina-7.0.34.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.41/tomcat-catalina-8.0.41.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.14/tomcat-catalina-7.0.14.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.19/tomcat-catalina-7.0.19.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.33/tomcat-catalina-8.0.33.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.30/tomcat-catalina-7.0.30.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.22/tomcat-catalina-7.0.22.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.76/tomcat-catalina-7.0.76.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.27/tomcat-catalina-7.0.27.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/8.0.44/tomcat-catalina-8.0.44.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.77/tomcat-catalina-7.0.77.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.75/tomcat-catalina-7.0.75.jar
    - http://central.maven.org/maven2/org/apache/tomcat/tomcat-catalina/7.0.37/tomcat-catalina-7.0.37.jar
